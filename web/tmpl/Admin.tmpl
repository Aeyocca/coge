<tmpl_if name="ADMIN_ONLY">
        YOU ARE NOT AN ADMIN!
</tmpl_if>

<TMPL_IF NAME='MAIN'>
<script type="text/javascript" src="js/coge/utils.js"></script>
<!--<script src="js/coge/colors.js"</script>-->
<script lanaguage="javascript" type="text/javascript" src="js/admin.js"></script>
<SCRIPT type="text/javascript" src="./js/jquery.fileupload.js"></SCRIPT>
<SCRIPT type="text/javascript" src="./js/jstree/jquery.jstree.js"></SCRIPT>

<style type="text/css">

@font-face {
        font-family: 'Glyphicons Halflings';
        src: url('./js/vendor/bootstrap/fonts/glyphicons-halflings-regular.eot');
	src: url('./js/vendor/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('./js/vendor/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('./js/vendor/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('./js/vendor/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');}

.glyphicon {
        position: relative;
        top: 1px;
        display: inline-block;
        font-family: 'Glyphicons Halflings';
        font-style: normal;
        font-weight: normal;
        line-height: 1;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
}

.glyphicon-asterisk:before {
        content: "\2a";
}

.jstree li a ins { display:none !important; }
.jstree.jstree-focused { background:white; }
</style>

<div id="master" style="position:relative;">
	<div id="searchBar" class="coge-bg inline padded ui-widget-content ui-corner-all">

	    	<td>Search:</td>
	    	<td>
	        	<input id="search_token" type="search" placeholder="Search" onkeyup="wait_to_search(search_stuff, this.value);" size="50" spellcheck="false" />
			<!--<input id="search_token" type="search" placeholder="Search" onkeyup="search_stuff(this.value);" size="50" spellcheck="false" />-->
	    	</td>
	</div>

	<div id="masterTable" style="position:relative;left:20px;padding-top:10px;padding-bottom:10px;" class="hidden result">
	
		<div style="padding-top:10px;">
		<span id='orgCount' class='coge-table-header' style='color:119911;'></span>
			<div id="orgArrow" onclick="toggle_arrow('#orgArrow');show_table('#orgList')" style='display:inline;'>
				<img src="picts/arrow-right-icon.png" class="link" style="width:10px;height:10px;"/>
			</div>
		<table cellspacing="5" class="hidden" id='orgList' style="border-top:0px solid green; padding-left:20px; padding-bottom:10px;"></table>
		</div>

		<div style="padding-top:10px;">
		<span id='genCount' class='coge-table-header' style='color:119911;'></span>
			<div id="genArrow" onclick="toggle_arrow('#genArrow');show_table('#genList')" style='display:inline;'>
                        	<img src="picts/arrow-right-icon.png" class="link" style="width:10px;height:10px;"/>
                	</div>
		<table cellspacing="5" class="hidden" id='genList' style="border-top:0px solid green; padding-left:20px; padding-bottom:10px;"></table>
		</div>

		<div style="padding-top:10px;">
		<span id='userCount' class='coge-table-header' style='color:119911;'></span>
			<div id="userArrow" onclick="toggle_arrow('#userArrow');show_table('#userList')" style='display:inline;'>
                        	<img src="picts/arrow-right-icon.png" class="link" style="width:10px;height:10px;"/>
                	</div>
		<table cellspacing="5" class="hidden" id='userList' style="border-top:0px solid green; padding-left:20px; padding-bottom:10px;"></table>
		</div>

		<div style="padding-top:10px;">
		<span id='usrgroupCount' class='coge-table-header' style='color:119911;'></span>
			<div id="usrGArrow" onclick="toggle_arrow('#usrGArrow');show_table('#usrgroupList')" style='display:inline;'>
        	                <img src="picts/arrow-right-icon.png" class="link" style="width:10px;height:10px;"/>
       		        </div>
		<table cellspacing="5" class="hidden" id='usrgroupList' style="border-top:0px solid green; padding-left:20px; padding-bottom:10px;"></table>
		</div>

		<div style="padding-top:10px;">
		<span id='noteCount' class='coge-table-header' style='color:119911;'></span>
			<div id="noteArrow" onclick="toggle_arrow('#noteArrow');show_table('#noteList')" style='display:inline;'>
                        	<img src="picts/arrow-right-icon.png" class="link" style="width:10px;height:10px;"/>
                	</div>
		<table cellspacing="5" class="hidden" id='noteList' style="border-top:0px solid green; padding-left:20px; padding-bottom:10px;"></table>
		</div>
	
		<div style="padding-top:10px;">
		<span id='expCount' class='coge-table-header' style='color:119911;'></span>
			<div id="expArrow" onclick="toggle_arrow('#expArrow');show_table('#expList')" style='display:inline;'>
                        	<img src="picts/arrow-right-icon.png" class="link" style="width:10px;height:10px;"/>
                	</div>
		<table cellspacing="5" class="hidden" id='expList' style="border-top:0px solid green; padding-left:20px; padding-bottom:10px;"></table>
		</div>
	</div>
</div>

<div id="userInfo" class="hidden" style"position:relative;">
	<div id="userHeader" style="padding-left:20px;">
		<button onclick="toggle_master()">Back</button>
	</div>

	<div id="userResults" style="position:relative;left:20px;padding-top:10px;padding-bottom:10px;" class="hidden result">

	</div>
</div>

<div id="user_dialog" class="hidden dialog_box" title="Select User">
	
	<input id="user_field" type="search" placeholder="Search" onkeyup="wait_to_search(search_users, this.value);" size="50" spellcheck="false" class="ui-autocomplete-input" autocomplete="on" role="textbox" aria-autocomplete="list" aria-haspopup="true">

	<!--<div id="load_log" class="small padded ui-widget-content ui-corner-all" style="overflow-y:auto;width:450px;height:200px;color:dimgray;">
	</div>
	<br>-->
	<!--<div id="loading_msg">
		<span class="small" style="float:right;">Link: <a></a></span>
		Please wait ... <img src="picts/ajax-loader.gif"/>
	</div>-->
  	<div class="coge-buttonset">
        	<span id="ok_button" style="float:right;" class="ui-button ui-corner-all coge-button">Ok</span>
	</div>
</div>

<div id="share_dialog" class="dialog_box hidden" title="Share Items"></div>

</TMPL_IF>

<TMPL_IF NAME='SHARE_DIALOG'>
	<script>
	$(function(){
		$("#share_input").autocomplete({
			source: [],
			focus: function() { return false; },
			select:
		    	function(event, ui) {
		    		$("#share_input")
		    			.val( ui.item.label )
		    			.data('select_id', ui.item.value);
		    		if (ui.item.value.split(':')[1] == ITEM_TYPE_USER) {
		    			$('#share_role_select').show();
		    		}
		    		else {
		    			$('#share_role_select').hide();
		    		}
		    		return false;
		    	},
		});
	});
	</script>
	<div style="margin:20px;margin-left:5px;">
		<span class="small" style="font-weight:bold;color:dimgray;">Who Has Access</span>
		<div class="small" style="overflow:auto;max-height:120px;padding-left:30px;padding-bottom:10px;border-top:1px solid lightgray;">
			<div style="padding-top:10px;">
				<TMPL_LOOP NAME="USER_LOOP">
					<div>
						<img src="picts/user-icon.png" width="11" height="11"/>
						<span style="color:dimgray;"><TMPL_VAR NAME="USER_FULL_NAME"> (<TMPL_VAR NAME="USER_NAME">) - <TMPL_VAR NAME="USER_ROLE"><span>
						<TMPL_IF NAME="USER_DELETE">
							<span onClick="$(this.parentNode).fadeOut('slow'); remove_items_from_user_or_group('<TMPL_VAR NAME=USER_ITEM>');" class="link ui-icon ui-icon-close"></span>
						</TMPL_IF>
						<br>
					</div>
				</TMPL_LOOP>
				<TMPL_LOOP NAME="GROUP_LOOP">
					<div>
						<img src="picts/group-icon.png" width="11" height="11"/>
						<span style="color:dimgray;"><TMPL_VAR NAME="GROUP_NAME"> (group) - <TMPL_VAR NAME="GROUP_ROLE"></span>
						<TMPL_IF NAME="GROUP_DELETE">
							<span onClick="$(this.parentNode).fadeOut('slow'); remove_items_from_user_or_group('<TMPL_VAR NAME=GROUP_ITEM>');" class="link ui-icon ui-icon-close"></span>
						</TMPL_IF>
						<br>
						<TMPL_LOOP NAME="GROUP_USER_LOOP">
							<span style="color:dimgray;padding:5px;padding-left:20px;">
							<img src="picts/user-icon.png" width="11" height="11"/>
							<TMPL_VAR NAME="GROUP_USER_FULL_NAME"> (<TMPL_VAR NAME="GROUP_USER_NAME">)<span><br>
						</TMPL_LOOP>
					</div>
				</TMPL_LOOP>
				<TMPL_LOOP NAME="NOTEBOOK_LOOP">
					<div>
						<img src="picts/notebook-icon.png" width="11" height="11"/>
						<span style="color:dimgray;"><TMPL_VAR NAME="NOTEBOOK_NAME"> (notebook)</span>
						<br>
						<TMPL_LOOP NAME="NOTEBOOK_USER_LOOP">
							<span style="color:dimgray;padding:5px;padding-left:20px;">
							<img src="picts/user-icon.png" width="11" height="11"/>
							<TMPL_VAR NAME="NOTEBOOK_USER_FULL_NAME"> (<TMPL_VAR NAME="NOTEBOOK_USER_NAME">)<span><br>
						</TMPL_LOOP>
					</div>
				</TMPL_LOOP>
				<TMPL_IF NAME="ACCESS_MSG">
					<div style="color:dimgray;font-style:italic;">
						<TMPL_VAR NAME="ACCESS_MSG">
					</div>
				</TMPL_IF>
			</div>
		</div>
		<br>
		<span class="small" style="font-weight:bold;color:dimgray;">Add Access</span>
		<div class="small" style="padding:20px;padding-left:30px;border-top:1px solid lightgray;">
			<TMPL_IF NAME="IS_EDITABLE">
				<span style="color:dimgray">Enter names or groups:</span><br>
				<input id="share_input" type="search" maxlength="40" spellcheck="false" style="width:20em;border:1px solid lightgray;" onclick='$(this).autocomplete("search");' onkeyup="wait_to_search(search_share, this.value);" />
				<select id="share_role_select" class="hidden"><TMPL_VAR NAME="ROLES"></select>
				<span href="javascript:void(0)" onClick="add_items_to_user_or_group();" class='ui-button ui-corner-all coge-button'>Add</span>
			<TMPL_ELSE>
				<span style="color:dimgray">
					You don't have permission to modify the selected item(s).
				</span>
			</TMPL_IF>
		</div>
	</div>
</TMPL_IF>
